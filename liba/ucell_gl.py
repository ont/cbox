import vec_gl

from vec import *

import ucell
ucell.UCell.data = {
    "a"   :  [ 0.4, ( 0   , 255 , 0   ) ],
    "b"   :  [ 0.4, ( 255 , 0   , 0   ) ],
    "H"   :  [ 0.4, ( 198 , 39  , 227 ) ],
    "He"  :  [ 0.4, ( 104 , 116 , 143 ) ],
    "Li"  :  [ 0.4, ( 192 , 140 , 76  ) ],
    "Be"  :  [ 0.4, ( 16  , 167 , 91  ) ],
    "B"   :  [ 0.4, ( 79  , 237 , 64  ) ],
    "C"   :  [ 0.4, ( 131 , 48  , 54  ) ],
    "N"   :  [ 0.4, ( 253 , 226 , 91  ) ],
    "O"   :  [ 0.4, ( 93  , 19  , 212 ) ],
    "F"   :  [ 0.4, ( 223 , 191 , 8   ) ],
    "Ne"  :  [ 0.4, ( 70  , 156 , 93  ) ],
    "Na"  :  [ 0.4, ( 173 , 85  , 4   ) ],
    "Mg"  :  [ 0.4, ( 84  , 44  , 75  ) ],
    "Al"  :  [ 0.4, ( 40  , 24  , 64  ) ],
    "Si"  :  [ 0.4, ( 180 , 107 , 42  ) ],
    "P"   :  [ 0.4, ( 244 , 224 , 246 ) ],
    "S"   :  [ 0.4, ( 200 , 142 , 27  ) ],
    "Cl"  :  [ 0.4, ( 14  , 254 , 218 ) ],
    "Ar"  :  [ 0.4, ( 87  , 61  , 72  ) ],
    "K"   :  [ 0.4, ( 0   , 14  , 190 ) ],
    "Ca"  :  [ 0.4, ( 138 , 128 , 250 ) ],
    "Sc"  :  [ 0.4, ( 228 , 198 , 87  ) ],
    "Ti"  :  [ 0.4, ( 230 , 7   , 231 ) ],
    "V"   :  [ 0.4, ( 102 , 209 , 180 ) ],
    "Cr"  :  [ 0.4, ( 188 , 67  , 47  ) ],
    "Mn"  :  [ 0.4, ( 79  , 193 , 252 ) ],
    "Fe"  :  [ 0.4, ( 158 , 166 , 84  ) ],
    "Co"  :  [ 0.4, ( 139 , 157 , 168 ) ],
    "Ni"  :  [ 0.4, ( 247 , 126 , 66  ) ],
    "Cu"  :  [ 0.4, ( 172 , 164 , 4   ) ],
    "Zn"  :  [ 0.4, ( 23  , 194 , 96  ) ],
    "Ga"  :  [ 0.4, ( 106 , 57  , 174 ) ],
    "Ge"  :  [ 0.4, ( 33  , 144 , 75  ) ],
    "As"  :  [ 0.4, ( 19  , 87  , 179 ) ],
    "Se"  :  [ 0.4, ( 111 , 166 , 23  ) ],
    "Br"  :  [ 0.4, ( 110 , 184 , 158 ) ],
    "Kr"  :  [ 0.4, ( 70  , 40  , 244 ) ],
    "Rb"  :  [ 0.4, ( 188 , 109 , 26  ) ],
    "Sr"  :  [ 0.4, ( 203 , 90  , 246 ) ],
    "Y"   :  [ 0.4, ( 18  , 11  , 118 ) ],
    "Zr"  :  [ 0.4, ( 105 , 153 , 182 ) ],
    "Nb"  :  [ 0.4, ( 108 , 193 , 200 ) ],
    "Mo"  :  [ 0.4, ( 219 , 114 , 165 ) ],
    "Tc"  :  [ 0.4, ( 108 , 232 , 127 ) ],
    "Ru"  :  [ 0.4, ( 68  , 99  , 181 ) ],
    "Rh"  :  [ 0.4, ( 243 , 65  , 17  ) ],
    "Pd"  :  [ 0.4, ( 217 , 30  , 209 ) ],
    "Ag"  :  [ 0.4, ( 237 , 102 , 175 ) ],
    "Cd"  :  [ 0.4, ( 168 , 90  , 20  ) ],
    "In"  :  [ 0.4, ( 226 , 31  , 208 ) ],
    "Sn"  :  [ 0.4, ( 221 , 146 , 242 ) ],
    "Sb"  :  [ 0.4, ( 229 , 101 , 71  ) ],
    "Te"  :  [ 0.4, ( 235 , 208 , 132 ) ],
    "I"   :  [ 0.4, ( 110 , 13  , 239 ) ],
    "Xe"  :  [ 0.4, ( 231 , 224 , 241 ) ],
    "Cs"  :  [ 0.4, ( 95  , 214 , 44  ) ],
    "Ba"  :  [ 0.4, ( 179 , 206 , 232 ) ],
    "Hf"  :  [ 0.4, ( 25  , 208 , 13  ) ],
    "Ta"  :  [ 0.4, ( 79  , 26  , 196 ) ],
    "W"   :  [ 0.4, ( 103 , 108 , 18  ) ],
    "Re"  :  [ 0.4, ( 232 , 146 , 177 ) ],
    "Os"  :  [ 0.4, ( 239 , 34  , 185 ) ],
    "Ir"  :  [ 0.4, ( 225 , 128 , 214 ) ],
    "Pt"  :  [ 0.4, ( 81  , 201 , 178 ) ],
    "Au"  :  [ 0.4, ( 48  , 217 , 212 ) ],
    "Hg"  :  [ 0.4, ( 163 , 3   , 14  ) ],
    "Tl"  :  [ 0.4, ( 46  , 193 , 223 ) ],
    "Pb"  :  [ 0.4, ( 108 , 33  , 62  ) ],
    "Bi"  :  [ 0.4, ( 35  , 30  , 159 ) ],
    "Po"  :  [ 0.4, ( 3   , 248 , 190 ) ],
    "At"  :  [ 0.4, ( 144 , 192 , 254 ) ],
    "Rn"  :  [ 0.4, ( 29  , 179 , 188 ) ],
    "Fr"  :  [ 0.4, ( 202 , 3   , 178 ) ],
    "Ra"  :  [ 0.4, ( 168 , 165 , 166 ) ],
    "Rf"  :  [ 0.4, ( 218 , 234 , 79  ) ],
    "Db"  :  [ 0.4, ( 116 , 185 , 188 ) ],
    "Sg"  :  [ 0.4, ( 110 , 211 , 98  ) ],
    "Bh"  :  [ 0.4, ( 57  , 115 , 212 ) ],
    "Hs"  :  [ 0.4, ( 167 , 109 , 205 ) ],
    "Mt"  :  [ 0.4, ( 80  , 39  , 225 ) ],
    "Ds"  :  [ 0.4, ( 26  , 248 , 243 ) ],
    "Rg"  :  [ 0.4, ( 3   , 7   , 6   ) ],
    "Uub" :  [ 0.4, ( 31  , 117 , 71  ) ],
    "Uut" :  [ 0.4, ( 46  , 53  , 176 ) ],
    "Uuq" :  [ 0.4, ( 178 , 104 , 53  ) ],
    "Uup" :  [ 0.4, ( 145 , 7   , 77  ) ],
    "Uuh" :  [ 0.4, ( 8   , 49  , 5   ) ],
    "Uus" :  [ 0.4, ( 141 , 87  , 161 ) ],
    "Uuo" :  [ 0.4, ( 154 , 38  , 182 ) ],
    "La"  :  [ 0.4, ( 210 , 242 , 124 ) ],
    "Ce"  :  [ 0.4, ( 210 , 241 , 17  ) ],
    "Pr"  :  [ 0.4, ( 231 , 42  , 84  ) ],
    "Nd"  :  [ 0.4, ( 122 , 28  , 235 ) ],
    "Pm"  :  [ 0.4, ( 37  , 135 , 12  ) ],
    "Sm"  :  [ 0.4, ( 18  , 203 , 108 ) ],
    "Eu"  :  [ 0.4, ( 35  , 204 , 139 ) ],
    "Gd"  :  [ 0.4, ( 7   , 129 , 102 ) ],
    "Tb"  :  [ 0.4, ( 61  , 126 , 32  ) ],
    "Dy"  :  [ 0.4, ( 210 , 86  , 182 ) ],
    "Ho"  :  [ 0.4, ( 212 , 238 , 15  ) ],
    "Er"  :  [ 0.4, ( 97  , 68  , 108 ) ],
    "Tm"  :  [ 0.4, ( 81  , 74  , 137 ) ],
    "Yb"  :  [ 0.4, ( 58  , 44  , 245 ) ],
    "Lu"  :  [ 0.4, ( 16  , 166 , 243 ) ],
    "Ac"  :  [ 0.4, ( 213 , 189 , 54  ) ],
    "Th"  :  [ 0.4, ( 142 , 100 , 191 ) ],
    "Pa"  :  [ 0.4, ( 236 , 55  , 60  ) ],
    "U"   :  [ 0.4, ( 151 , 67  , 125 ) ],
    "Np"  :  [ 0.4, ( 110 , 246 , 44  ) ],
    "Pu"  :  [ 0.4, ( 12  , 180 , 183 ) ],
    "Am"  :  [ 0.4, ( 237 , 165 , 82  ) ],
    "Cm"  :  [ 0.4, ( 93  , 255 , 79  ) ],
    "Bk"  :  [ 0.4, ( 192 , 219 , 33  ) ],
    "Cf"  :  [ 0.4, ( 119 , 183 , 4   ) ],
    "Es"  :  [ 0.4, ( 14  , 211 , 93  ) ],
    "Fm"  :  [ 0.4, ( 93  , 198 , 87  ) ],
    "Md"  :  [ 0.4, ( 192 , 191 , 179 ) ],
    "No"  :  [ 0.4, ( 125 , 211 , 35  ) ],
    "Lr"  :  [ 0.4, ( 16  , 29  , 157 ) ],
    "D"   :  [ 0.4, ( 34  , 82  , 200 ) ],
}

def draw( self, api ):
    v1, v2, v3 = self.rep.v1, self.rep.v2, self.rep.v3
    v = v1 + v2 + v3
    #api.gl.dist = 1.5 * v.vlen()

    v0 = Vec( 0.0, 0.0, 0.0 )
    api.line( v0, self.rep.v1, (1,1,1) )
    api.line( v0, self.rep.v2, (1,1,1) )
    api.line( v0, self.rep.v3, (1,1,1) )

    for name, vecs in self:
        for v in vecs:
            va = v.x * v1 + v.y * v2 + v.z * v3
            data = self.data.get( name, [ 0.04, (255,255,255) ] )
            color = map( lambda c: c/255.0, data[ 1 ]  )
            api.sphere( va, data[ 0 ], color  )

ucell.UCell.draw = draw

